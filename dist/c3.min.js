var c3=function(){function g(a,b){return a===b}function h(b){return g(b,a)}function i(a,b){if(a!==b.type)throw"invalid type: expected '"+a+"', "+"received '"+b.type+"'"}function j(a){return parseInt(a,10)}function k(a){return i("piece",a),c3.square(a.size,a.playerId)}function l(a){return JSON.stringify(a)}function m(a){return JSON.parse(a)}function n(a,b){return f[a][b]}function o(){c3.game.addResetNotification(c3.board.reset),c3.game.addResetNotification(c3.ui.run),c3.game.reset()}"use strict";var a=-1,b="a",c="A",d="b",e="B",f=[[b,d],[c,e]];return{none:a,player1:0,player2:1,smallPiece:0,largePiece:1,isNone:h,equals:g,ensureType:i,toInt:j,toSquare:k,serialize:l,deserialize:m,getContent:n,init:o}}();c3.player=function(a){function c(c){return c3.ensureType(b,c),c3.equals(a,c.id)}"use strict";var b="player";return{type:b,id:a,equals:c}},c3.piece=function(a,b){function g(c){return c?"":"piece-"+a+" player-"+b}function h(c){return c?0:c3.getContent(a,b)}function i(){return c3.isNone(a)||c3.isNone(b)}function j(d){return c3.ensureType(c,d),c3.equals(a,d.size)&&c3.equals(b,d.playerId)}function k(){return a===c3.none?c3.smallPiece:c3.largePiece}"use strict";var c="piece",d,e,f;return f=i(),d=h(f),e=g(f),{type:c,content:d,className:e,size:a,playerId:b,isNoPiece:f,equals:j,getNextSize:k}},c3.square=function(a,b){return"use strict",{type:"square",playerId:b,size:a}},c3.game=function(a){function h(){c=a.serialize({type:b,playerId:d,squares:e,over:g})}function i(a){f.push(a)}function j(a){d=a,h()}function k(a,b){e[a]=b,h()}function l(){g=!0,h()}function m(){return a.deserialize(c)}function n(i){var j=f.length-1;a.ensureType(b,i);if(a.equals(c,a.serialize(i)))return;d=i.playerId,e=i.squares,g=i.over,h();if(j>0)while(j>=0)f[j].call(null,i),j-=1}function o(){var c=c3.square(a.none,a.none),d;for(d=0;d<9;d+=1)e[d]=c;n({type:b,playerId:a.player1,squares:e,over:g})}"use strict";var b="game",c=null,d=a.player1,e=[],f=[],g=!1;return{get:m,set:n,reset:o,saveCurrentPlayerId:j,saveSquare:k,addResetNotification:i,setGameOver:l}}(c3),c3.board=function(a){function d(b){var d=c.length-1,e=b.squares,f,g;while(d>=0){g=!1;while(!g){f=e[c[d][0]].playerId;if(a.isNone(f))g=!0;else{if(a.equals(f,e[c[d][1]].playerId)&&a.equals(f,e[c[d][2]].playerId))return!0;g=!0}}d-=1}return!1}function e(a){return b[a]}function f(c,e,f){b[c]=e,f.saveSquare(c,a.toSquare(e)),f.saveCurrentPlayerId(a.equals(e.playerId,a.player1)?a.player2:a.player1),d(f.get())&&f.setGameOver()}function g(b){return a.ensureType("square",b),a.piece(b.size,b.playerId)}function h(a){var c=a.squares,d;for(d=0;d<9;d+=1)b[d]=g(c[d])}"use strict";var b=[],c=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];return{getSquarePiece:e,setSquarePiece:f,reset:h}}(c3),c3.ui=function(a,b,c,d){function g(a,e,f){c.setSquarePiece(a,b.piece(e,f),d)}function h(b,c,d){a("#"+b).text(d.content).removeClass(c.className).addClass(d.className)}function i(e){var f,i;f=c.getSquarePiece(e),i=b.piece(f.getNextSize(),d.get().playerId),g(e,i.size,i.playerId),h(e,f,i),i.size===b.largePiece&&a("#"+e).off("click").removeClass("sqr").addClass("sqr-off")}function j(){f.on("click",function(a){i(b.toInt(a.target.id)),e.css("cursor","pointer")}),f.mousedown(function(a){a.originalEvent.preventDefault?a.originalEvent.preventDefault():event.returnValue=!1}),e.fadeIn("slow")}"use strict";var e=a("#gridContainer"),f=a(".sqr");return{run:j,clickSquare:i}}(jQuery,c3,c3.board,c3.game);